// æ–‡ä»¶è·¯å¾„: /d%3A/workspace/RustLearn/RustDesignPattern/src/EnterpriseAppPattern/OfflineConcurrencyPatterns/mod.rs

//! # ç¦»çº¿å¹¶å‘æ¨¡å¼ (Offline Concurrency Patterns)
//!
//! ## æ¨¡å¼åˆ†ç±»
//! æœ¬ç›®å½•åŒ…å«å¤„ç†ç¦»çº¿å¹¶å‘æ§åˆ¶çš„è®¾è®¡æ¨¡å¼ï¼š
//!
//! ### 1. ä¹è§‚ç¦»çº¿é” (Optimistic Offline Lock)
//! - **æ–‡ä»¶**: `optimistic_offline_lock.rs`
//! - **æè¿°**: é€šè¿‡ç‰ˆæœ¬æ§åˆ¶é˜²æ­¢å¤šç”¨æˆ·åŒæ—¶ä¿®æ”¹åŒä¸€æ•°æ®æ—¶çš„å†²çª
//! - **ä¼˜ç‚¹**: æ€§èƒ½å¥½ï¼Œå†²çªå°‘æ—¶æ•ˆç‡é«˜ï¼Œæ”¯æŒé«˜å¹¶å‘è¯»å–
//! - **é€‚ç”¨**: å†²çªæ¦‚ç‡è¾ƒä½çš„åœºæ™¯ï¼Œè¯»å¤šå†™å°‘çš„ç³»ç»Ÿ
//!
//! ### 2. æ‚²è§‚ç¦»çº¿é” (Pessimistic Offline Lock)
//! - **æ–‡ä»¶**: `pessimistic_offline_lock.rs`
//! - **æè¿°**: é€šè¿‡é”å®šèµ„æºé˜²æ­¢å…¶ä»–ç”¨æˆ·è®¿é—®æ­£åœ¨ç¼–è¾‘çš„æ•°æ®
//! - **ä¼˜ç‚¹**: é¿å…å†²çªï¼Œæ•°æ®ä¸€è‡´æ€§å¼ºï¼Œé€‚åˆé«˜å†²çªåœºæ™¯
//! - **é€‚ç”¨**: å†²çªæ¦‚ç‡è¾ƒé«˜çš„åœºæ™¯ï¼Œå…³é”®æ•°æ®ä¿æŠ¤
//!
//! ### 3. ç²—ç²’åº¦é” (Coarse-Grained Lock)
//! - **æ–‡ä»¶**: `coarse_grained_lock.rs`
//! - **æè¿°**: ä½¿ç”¨å•ä¸€é”æ¥æ§åˆ¶å¯¹ä¸€ç»„ç›¸å…³å¯¹è±¡çš„è®¿é—®
//! - **ä¼˜ç‚¹**: ç®€åŒ–é”ç®¡ç†ï¼Œé¿å…æ­»é”ï¼Œå‡å°‘é”å¼€é”€
//! - **é€‚ç”¨**: èšåˆæ ¹é”å®šï¼Œäº‹åŠ¡æ€§æ“ä½œï¼Œç›¸å…³å¯¹è±¡ç»„
//!
//! ### 4. éšå¼é” (Implicit Lock)
//! - **æ–‡ä»¶**: `implicit_lock.rs`
//! - **æè¿°**: é€šè¿‡åº”ç”¨æ¶æ„éšå¼åœ°ç®¡ç†å¹¶å‘ï¼Œè€Œéæ˜¾å¼é”å®š
//! - **ä¼˜ç‚¹**: ç®€åŒ–ç¼–ç¨‹æ¨¡å‹ï¼Œå‡å°‘é”™è¯¯ï¼Œè‡ªåŠ¨é”ç®¡ç†
//! - **é€‚ç”¨**: å•çº¿ç¨‹å¤„ç†æ¨¡å‹ï¼ŒActoræ¨¡å‹ï¼Œé˜Ÿåˆ—å¤„ç†

pub mod optimistic_offline_lock;
pub mod pessimistic_offline_lock;
pub mod coarse_grained_lock;
pub mod implicit_lock;

pub use optimistic_offline_lock::*;
pub use pessimistic_offline_lock::*;
pub use coarse_grained_lock::*;
pub use implicit_lock::*;

/// æ¼”ç¤ºæ‰€æœ‰ç¦»çº¿å¹¶å‘æ¨¡å¼
pub fn demo_all() {
    println!("=== ç¦»çº¿å¹¶å‘æ¨¡å¼æ€»è§ˆ ===\n");
    
    println!("ğŸ“‹ å¹¶å‘æ§åˆ¶ç­–ç•¥å¯¹æ¯”è¡¨:");
    println!("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”");
    println!("â”‚ æ¨¡å¼ç±»å‹         â”‚ é”å®šæ—¶æœº         â”‚ æ€§èƒ½ç‰¹ç‚¹         â”‚ é€‚ç”¨åœºæ™¯         â”‚");
    println!("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤");
    println!("â”‚ ä¹è§‚ç¦»çº¿é”       â”‚ æäº¤æ—¶æ£€æŸ¥       â”‚ é«˜å¹¶å‘æ€§èƒ½       â”‚ ä½å†²çªåœºæ™¯       â”‚");
    println!("â”‚ æ‚²è§‚ç¦»çº¿é”       â”‚ å¼€å§‹æ—¶é”å®š       â”‚ ä¸€è‡´æ€§ä¼˜å…ˆ       â”‚ é«˜å†²çªåœºæ™¯       â”‚");
    println!("â”‚ ç²—ç²’åº¦é”         â”‚ èšåˆçº§åˆ«é”       â”‚ ç®€åŒ–ç®¡ç†         â”‚ ç›¸å…³å¯¹è±¡ç»„       â”‚");
    println!("â”‚ éšå¼é”           â”‚ æ¶æ„å±‚é¢æ§åˆ¶     â”‚ è‡ªåŠ¨åŒ–ç®¡ç†       â”‚ å•çº¿ç¨‹æ¨¡å‹       â”‚");
    println!("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜");
    
    println!("\nğŸ¯ é€‰æ‹©ç­–ç•¥æŒ‡å—:");
    
    println!("\nâ€¢ ä¹è§‚ç¦»çº¿é” (Optimistic Offline Lock):");
    println!("  âœ… è¯»æ“ä½œè¿œå¤šäºå†™æ“ä½œ");
    println!("  âœ… ç”¨æˆ·å†²çªæ¦‚ç‡è¾ƒä½");
    println!("  âœ… éœ€è¦é«˜å¹¶å‘æ€§èƒ½");
    println!("  âœ… å¯ä»¥æ¥å—å¶å°”çš„å†²çªé‡è¯•");
    println!("  âŒ é«˜å†²çªç¯å¢ƒ");
    println!("  âŒ å†²çªä»£ä»·æé«˜çš„åœºæ™¯");
    
    println!("\nâ€¢ æ‚²è§‚ç¦»çº¿é” (Pessimistic Offline Lock):");
    println!("  âœ… æ•°æ®å†²çªæ¦‚ç‡è¾ƒé«˜");
    println!("  âœ… å†²çªé‡è¯•ä»£ä»·å¾ˆé«˜");
    println!("  âœ… éœ€è¦å¼ºæ•°æ®ä¸€è‡´æ€§");
    println!("  âœ… å…³é”®ä¸šåŠ¡æ•°æ®ä¿æŠ¤");
    println!("  âŒ é«˜å¹¶å‘è¯»å–éœ€æ±‚");
    println!("  âŒ é”å®šæ—¶é—´è¿‡é•¿");
    
    println!("\nâ€¢ ç²—ç²’åº¦é” (Coarse-Grained Lock):");
    println!("  âœ… èšåˆæ ¹å’Œç›¸å…³å®ä½“éœ€è¦ä¸€èµ·é”å®š");
    println!("  âœ… ç®€åŒ–é”ç®¡ç†å¤æ‚æ€§");
    println!("  âœ… é¿å…åˆ†å¸ƒå¼æ­»é”");
    println!("  âœ… äº‹åŠ¡æ€§ä¸šåŠ¡æ“ä½œ");
    println!("  âŒ éœ€è¦ç»†ç²’åº¦å¹¶å‘æ§åˆ¶");
    
    println!("\nâ€¢ éšå¼é” (Implicit Lock):");
    println!("  âœ… ç®€åŒ–å¼€å‘å¤æ‚æ€§");
    println!("  âœ… é¿å…æ˜¾å¼é”ç®¡ç†é”™è¯¯");
    println!("  âœ… Actoræ¨¡å‹æˆ–æ¶ˆæ¯é˜Ÿåˆ—");
    println!("  âœ… å•çº¿ç¨‹äº‹ä»¶å¾ªç¯");
    println!("  âŒ éœ€è¦ç²¾ç»†å¹¶å‘æ§åˆ¶");
    
    println!("\nğŸ’¡ è®¾è®¡è€ƒè™‘å› ç´ :");
    println!("  1. å†²çªæ¦‚ç‡åˆ†æ:");
    println!("     - ä½å†²çªç‡ (< 5%) â†’ ä¹è§‚é”");
    println!("     - ä¸­ç­‰å†²çªç‡ (5-20%) â†’ æ··åˆç­–ç•¥");
    println!("     - é«˜å†²çªç‡ (> 20%) â†’ æ‚²è§‚é”");
    
    println!("\n  2. æ€§èƒ½è¦æ±‚:");
    println!("     - é«˜å¹¶å‘è¯»å– â†’ ä¹è§‚é”");
    println!("     - ä¸€è‡´æ€§ä¼˜å…ˆ â†’ æ‚²è§‚é”");
    println!("     - ç®€åŒ–ç®¡ç† â†’ ç²—ç²’åº¦é”");
    println!("     - å¼€å‘æ•ˆç‡ â†’ éšå¼é”");
    
    println!("\n  3. ä¸šåŠ¡ç‰¹æ€§:");
    println!("     - é•¿æ—¶é—´ç¼–è¾‘ â†’ æ‚²è§‚é”");
    println!("     - å¿«é€Ÿæäº¤ â†’ ä¹è§‚é”");
    println!("     - èšåˆæ“ä½œ â†’ ç²—ç²’åº¦é”");
    println!("     - ç®€å•æµç¨‹ â†’ éšå¼é”");
    
    println!("\nğŸ”— æ¨¡å¼ç»„åˆç­–ç•¥:");
    println!("  â€¢ åˆ†å±‚é”å®šç­–ç•¥ï¼š");
    println!("    - èšåˆæ ¹ä½¿ç”¨ç²—ç²’åº¦é”");
    println!("    - å®ä½“ä½¿ç”¨ä¹è§‚é”");
    println!("    - å€¼å¯¹è±¡æ— éœ€é”å®š");
    
    println!("\n  â€¢ æ··åˆé”å®šç­–ç•¥ï¼š");
    println!("    - è¯»æ“ä½œä½¿ç”¨ä¹è§‚é”");
    println!("    - å†™æ“ä½œä½¿ç”¨æ‚²è§‚é”");
    println!("    - æ‰¹é‡æ“ä½œä½¿ç”¨ç²—ç²’åº¦é”");
    
    println!("\n  â€¢ æ¸è¿›å¼ç­–ç•¥ï¼š");
    println!("    - å¼€å§‹ä½¿ç”¨éšå¼é”");
    println!("    - å‘ç°å†²çªåå‡çº§åˆ°ä¹è§‚é”");
    println!("    - é«˜å†²çªæ—¶ä½¿ç”¨æ‚²è§‚é”");
    
    println!("\n{}", "=".repeat(80));
    
    // æ¼”ç¤ºæ‰€æœ‰ç¦»çº¿å¹¶å‘æ¨¡å¼
    optimistic_offline_lock::demo();
    println!("\n{}", "-".repeat(80));
    
    pessimistic_offline_lock::demo();
    println!("\n{}", "-".repeat(80));
    
    coarse_grained_lock::demo();
    println!("\n{}", "-".repeat(80));
    
    implicit_lock::demo();
    
    println!("\n=== ç¦»çº¿å¹¶å‘æ¨¡å¼æ¼”ç¤ºå…¨éƒ¨å®Œæˆ ===");
    
    println!("\nğŸ“ å®æ–½å»ºè®®:");
    println!("  1. å†²çªæ£€æµ‹å’Œå¤„ç†:");
    println!("     - å®ç°ç‰ˆæœ¬æ£€æŸ¥æœºåˆ¶");
    println!("     - æä¾›å‹å¥½çš„å†²çªè§£å†³ç•Œé¢");
    println!("     - æ”¯æŒè‡ªåŠ¨åˆå¹¶ç­–ç•¥");
    
    println!("\n  2. é”è¶…æ—¶å’Œæ¸…ç†:");
    println!("     - è®¾ç½®åˆç†çš„é”è¶…æ—¶æ—¶é—´");
    println!("     - å®ç°é”æ¸…ç†æœºåˆ¶");
    println!("     - ç›‘æ§é”ä½¿ç”¨æƒ…å†µ");
    
    println!("\n  3. æ€§èƒ½ä¼˜åŒ–:");
    println!("     - æœ€å°åŒ–é”çš„ç²’åº¦");
    println!("     - å‡å°‘é”æŒæœ‰æ—¶é—´");
    println!("     - ä½¿ç”¨è¯»å†™é”åˆ†ç¦»");
    
    println!("\n  4. é”™è¯¯å¤„ç†:");
    println!("     - ä¼˜é›…å¤„ç†é”å†²çª");
    println!("     - æä¾›é‡è¯•æœºåˆ¶");
    println!("     - è®°å½•å†²çªç»Ÿè®¡ä¿¡æ¯");
    
    println!("\nğŸ“š ç›¸å…³æŠ€æœ¯:");
    println!("  â€¢ æ•°æ®åº“äº‹åŠ¡éš”ç¦»çº§åˆ«");
    println!("  â€¢ åˆ†å¸ƒå¼é”å®ç°ï¼ˆRedisã€Zookeeperï¼‰");
    println!("  â€¢ äº‹ä»¶æº¯æºå’ŒCQRS");
    println!("  â€¢ Actoræ¨¡å‹å’Œæ¶ˆæ¯ä¼ é€’");
    println!("  â€¢ è½¯ä»¶äº‹åŠ¡å†…å­˜ï¼ˆSTMï¼‰");
    
    println!("\nğŸš€ æ¼”è¿›è·¯å¾„:");
    println!("  â€¢ å•æœº â†’ åˆ†å¸ƒå¼é”");
    println!("  â€¢ åŒæ­¥ â†’ å¼‚æ­¥å¤„ç†");
    println!("  â€¢ é”åŸºç¡€ â†’ æ— é”ç®—æ³•");
    println!("  â€¢ ä¼ ç»Ÿäº‹åŠ¡ â†’ äº‹ä»¶é©±åŠ¨");
    println!("  â€¢ å¼ºä¸€è‡´æ€§ â†’ æœ€ç»ˆä¸€è‡´æ€§");
} 